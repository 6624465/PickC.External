@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@{
    var fareChartList = (List<PickC.External.Contracts.FareChart>)TempData["TD:FareChartList"];
}
@section Styles{
    <style type="text/css">
        .booknow-btn-red {
            background: red;
            color: #fff200;
            position: relative;
            padding: 5px 15px;
            border: 1px solid #000;
            bottom: 8px;
        }

            .booknow-btn-red:hover {
                background: red;
                color: #000;
                border: 1px solid #000;
            }
    </style>
}
<!--main content-->
<div class="container-fluid">
    <div class="row">
        <div class="bg-gif responsiveImage">
            <div class="container-fluid">
                <div class="col-md-4 col-xs-12">

                    <div class="slider-carousel">
                        <div id="myCarousel" class="carousel slide" data-ride="carousel">
                            <!-- Indicators -->
                            <ol class="carousel-indicators">
                                <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                                <li data-target="#myCarousel" data-slide-to="1"></li>
                                <li data-target="#myCarousel" data-slide-to="2"></li>
                                <li data-target="#myCarousel" data-slide-to="3"></li>
                                <li data-target="#myCarousel" data-slide-to="4"></li>
                                <li data-target="#myCarousel" data-slide-to="5"></li>

                            </ol>
                            <!-- Wrapper for slides -->
                            <div class="carousel-inner">
                                <div class="item active">
                                    <img src="@Url.Content("~/images/n1.png")" class="img-responsive" alt="">
                                </div>
                                <div class="item">
                                    <img src="@Url.Content("~/images/n2.jpg")" class="img-responsive" alt="">
                                </div>
                                <div class="item">
                                    <img src="@Url.Content("~/images/n8.png")" class="img-responsive" alt="">
                                </div>
                                <div class="item">
                                    <img src="@Url.Content("~/images/n5.jpg")" class="img-responsive" alt="">
                                </div>
                                <div class="item">
                                    <img src="@Url.Content("~/images/n4.jpg")" class="img-responsive" alt="">
                                </div>
                                <div class="item">
                                    <img src="@Url.Content("~/images/amount.png")" class="img-responsive" alt="">
                                </div>

                                <!-- Left and right controls -->
                                <a class="left carousel-control" href="#myCarousel" data-slide="prev">
                                    <span class="sr-only">Previous</span>
                                </a>
                                <a class="right carousel-control" href="#myCarousel" data-slide="next">
                                    <span class="sr-only">Next</span>
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="mobile"></div>
                </div>
                <div class="col-md-6 col-xs-12">
                    <div class="main-slider-text">

                    </div>
                    <div class="clear-fix"></div>
                    <div class="estimate-bg">
                        <form action="" id="frmFromToLocation" name="frmFromToLocation">
                            <div class="form-group estimate-form">
                                <input type="text"
                                       name="fromLocation"
                                       class="form-control"
                                       id="fromLocation"
                                       placeholder="Enter From Location" />
                                <img src="@Url.Content("~/images/source1.png")" class="img-responsive" />
                            </div>
                            <div class="form-group estimate-form">
                                <input type="text"
                                       class="form-control"
                                       id="toLocation"
                                       placeholder="Enter To Location"
                                       name="toLocation" />
                                <img src="@Url.Content("~/images/destination1.png")" class="img-responsive" />
                            </div>
                            <a class="btn btn-default" onclick="FromToLocations()">Get Trip Estimate</a>
                            <a class="btn btn-primary" href="javascript::" onclick="Clear()">Clear</a>
                        </form>
                    </div>
                </div>
                <div class="col-md-2">
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="app-icons-div">
            <div class="container-fluid">

                <div class="col-md-3 app-icons">
                    <a href="#"><img src="@Url.Content("~/images/goo.png")" /></a>
                    <a href="#"><img src="@Url.Content("~/images/app.png")" /></a>
                </div>
                <div class="col-md-6">
                    <div class="slider-text">
                        <h1>Pick-C India’s Best Logistics App</h1>
                    </div>
                </div>
                <div class="col-md-3">
                    <button class="track-crn-btn">Track Cargo with CRN</button>
                </div>
            </div>
        </div>
    </div>
</div>
@using (Html.BeginForm("TripEstimate", "CustomerInquiry", FormMethod.Post, new { id = "frmTripEstimate", name = "frmTripEstimate" }))
{
    <div class="modal fade" id="get-trip-estimate" tabindex="-1" role="dialog"
         aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog center-modal modal-sm">
            <div class="modal-content">
                <!-- Modal Header -->
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <!-- Modal Body -->
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            @Html.TextBox("CustomerName", "", new { placeholder = "Enter Name", @class = "form-control alphaonly" })
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            @Html.TextBox("MobileNo", "", new { placeholder = "Enter Mobile Number", @class = "form-control numCss MobileNoCss" })
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            @Html.TextBox("EmailID", "", new { placeholder = "Enter Email", @class = "form-control" })
                            @Html.Hidden("Distance")
                            @Html.Hidden("Duration")
                        </div>
                    </div>
                </div>
                <!-- Modal Footer -->
                <div class="modal-footer">
                    <button type="button" onclick="TripEstimate()" class="btn get-estimate-btn">
                        Get Estimate Now
                    </button>
                    <!--data-toggle="modal" data-target="#prices-list" data-dismiss="modal"-->
                </div>
            </div>
        </div>
    </div>
}
    <div class="modal fade" id="prices-list" role="dialog">
        <div class="modal-dialog scroll center-modal">
            <div class="modal-content">
                <div class="modal-header custom-header">
                    <button type="button" class="close" data-dismiss="modal">×</button>
                    <h4 class="modal-title">Approx. Estimate Prices</h4>
                </div>
                <div class="modal-body">
                    <div class="row space-top prices-list-bg">
                        <div class="col-md-4 col-xs-4 custom-height">
                            <div class="pricelist-logo">
                                <img src="@Url.Content("~/images/logo.png")" class="img-responsive" alt="pickcargo logo" />
                            </div>
                        </div>
                        <div class="col-md-4 col-xs-4 custom-height">
                            <div class="open-close-img">
                                <img src="@Url.Content("~/images/open.png")" class="img-responsive" alt="" />
                            </div>
                            <h5 class="inline">Open Truck</h5>
                        </div>
                        <div class="col-md-4 col-xs-4">
                            <div class="open-close-img">
                                <img src="@Url.Content("~/images/closed.png")" class="img-responsive" alt="" />
                            </div>
                            <h5 class="inline">Close Truck</h5>
                        </div>
                    </div>
                    @if (fareChartList != null)
        {
            for (var i = 0; i < fareChartList.Count; i++)
            {
                <div class="row space-top">
                    <div class="col-md-4 col-xs-4 custom-height custom-truck-div">
                        <div class="vehicle-types">
                            <div class="icon">
                                <img src="@Url.Content("~/images/" + fareChartList[i].vehicleGroupDesc + ".png")" class="img-responsive" alt="Mini-Truck" />
                            </div>
                            <h3>@fareChartList[i].vehicleGroupDesc</h3>
                        </div>
                    </div>
                    <div class="color-bg">
                        <div class="col-md-4 col-xs-4 custom-height">
                            <div class="Prices-list">
                                <h3>&#x20B9;@fareChartList[i].OpenCharge.ToString("0.##")</h3>
                                <a href="#" @if (fareChartList[i].IsOpenOnline) { <text> class="booknow-btn" </text>  } else { <text> class="booknow-btn-red" </text> }>Book Now</a><!--<div class="avail-unavail-btn"></div>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 col-xs-4 custom-height">
                        <div class="Prices-list">
                            <h3>&#x20B9;@fareChartList[i].CloseCharge.ToString("0.##")</h3>
                            <a href="#" @if (fareChartList[i].IsCloseOnline) { <text> class="booknow-btn" </text>  } else { <text> class="booknow-btn-red" </text> }>Book Now</a>
                        </div>
                    </div>
                </div>
}
}
                </div>
                <div class="modal-footer custom-footer">
                    <h4 class="note-text"><strong>Note:&nbsp;</strong>This is an approximate estimate actual cost travel time may differ.</h4>
                </div>
            </div>
        </div>
    </div>
        <!-- modals content-->
        @section Scripts{
            <script src="@Url.Content("~/Scripts/jquery.validate.js")"></script>
            <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD7WVBL9AmhKs1QAr4x7mArA2mKZY-9nUo&v=3.exp&libraries=places&sensor=true"></script>
            <script type="text/javascript">
        var source, destination;
        var directionsDisplay;
        var options = {};

        var southWest = new google.maps.LatLng(52.318274, 4.728856);
        var northEast = new google.maps.LatLng(52.431157, 5.068373);
        var defaultBounds = new google.maps.LatLngBounds(southWest, northEast);
        options = {
            bounds: defaultBounds,
            types: ['address'],//geocode
            componentRestrictions: { country: 'in' }
        };
        var directionsService = new google.maps.DirectionsService();
        google.maps.event.addDomListener(window, 'load', function () {
            new google.maps.places.Autocomplete(document.getElementById('fromLocation'), options);
            new google.maps.places.Autocomplete(document.getElementById('toLocation'), options);
            directionsDisplay = new google.maps.DirectionsRenderer({ 'draggable': true });
        });

        $(function () {
            @{
                var isTripEstimate = ViewData["vdIsTripEstimate"];
                if(isTripEstimate != null && (bool)isTripEstimate && fareChartList != null)
                {
                    <text>
                        $('#prices-list').modal('show');
                    </text>
                }
            }

            $('#frmTripEstimate').validate({
                rules: {
                    CustomerName: {
                        required: true,
                        maxlength: 50                        
                    },
                    MobileNo: {
                        required: true,
                        minlength: 10,
                        maxlength: 10                        
                        //regex: /^[789]\d{9}$/ ///^[7-9][0-9]{9}$/ //'^[789]\d{9}$'
                    },
                    EmailID: {
                        email: true,
                        required: false,
                        maxlength: 50
                    }
                },
                messages: {
                    CustomerName: {
                        required: 'Please enter name'
                    },
                    MobileNo: {
                        required: 'Please enter valid mobile number'
                    }
                }
            });

            $('#frmFromToLocation').validate({
                rules: {
                    fromLocation: {
                        required: true
                    },
                    toLocation: {
                        required: true
                    }
                }
            });

            
        });

        function FromToLocations() {
            if ($('#frmFromToLocation').valid()) {
                $('#get-trip-estimate').modal('show');
            }
            else {
                alert("Please enter From and To Locations");
}
        }



        function TripEstimate() {
            if ($('#frmTripEstimate').valid()) {
                DrawMapNew($('#fromLocation').val(), $('#toLocation').val());
                //$('#frmTripEstimate').submit();
            }
        }

        function DrawMapNew(start, end) {
            $('#pickuparea').html(start);
            $('#dropoffarea').html(end);
            //document.getElementById('dvMap').style.height = '470px';
            //var mapDiv = document.getElementById('dvMap');
            var latlng = new google.maps.LatLng(26.90, 76.35);
            var options = {
                mapTypeId: google.maps.MapTypeId.ROADMAP,
                navigationControl: true,
                scaleControl: true,
                disableDoubleClickZoom: true,
                scrollwheel: false,
                streetViewControl: true
            };
            var waypts = [];
            var request = {
                origin: start,
                destination: end,
                waypoints: waypts,
                optimizeWaypoints: false,
                travelMode: google.maps.DirectionsTravelMode.DRIVING,
                unitSystem: google.maps.DirectionsUnitSystem.METRIC
            };

            directionsService = new google.maps.DirectionsService();
            directionsService.route(request, function (response, status) {
                debugger;
                if (status == google.maps.DirectionsStatus.OK) {
                    $('#Distance').val(response.routes[0].legs[0].distance.value / 1000);
                    $('#Duration').val(response.routes[0].legs[0].duration.value / 60);
                    $('#frmTripEstimate').submit();
                    //$('#booking_Latitude').val(response.routes[0].legs[0].start_location.lat());
                    //$('#booking_Longitude').val(response.routes[0].legs[0].start_location.lng());
                    //$('#estdistance').html(response.routes[0].legs[0].distance.text);
                    //$('#esttime').html(response.routes[0].legs[0].duration.text);
                    //var Dist = response.routes[0].legs[0].distance.text;
                    //var Time = response.routes[0].legs[0].duration.text;
                    //document.getElementById("duration1").innerHTML = Time;
                    //document.getElementById("duration2").innerHTML = Time;
                    //document.getElementById("distancesone").innerHTML = Dist;
                    //document.getElementById("distancestwo").innerHTML = Dist;
                }

                //map = new google.maps.Map(mapDiv, options);
                /*  var adUnitDiv = document.createElement('div');



                  var adUnitOptions = {

                      format: google.maps.adsense.AdFormat.BUTTON,

                      position: google.maps.ControlPosition.RIGHT_BOTTOM,

                      publisherId: 'ca-pub-5545853276936929',

                      map: map,

                      visible: true

                  };

                  var adUnit = new google.maps.adsense.AdUnit(adUnitDiv, adUnitOptions);*/



                directionsDisplay = new google.maps.DirectionsRenderer({

                });
                directionsDisplay.setMap(map);
                directionsDisplay.setPanel(document.getElementById('panel'));
                directionsDisplay.setDirections(response);
            });
            $('#tripEstimateModal').modal('show');
        }

        function Clear() {
            $('#fromLocation, #toLocation').val('');
        }
            </script>
        }
